# 语句和程序结构

# 章节介绍

欢迎来到C++教程的第一章。

在这一章中，我们将首先了解一些对每个C++程序员都至关重要的主题。因为涉及到的主题很多，所以我们将在相当浅的层次上介绍大多数主题(刚好够用)。本章的目的是帮助你理解基本的C++程序是如何构造的。在本章结束的时候，你能够自己编写一些简单的程序。

在以后的章节中，我们将重新审视这些主题中的打不，并且进行更详细的探讨。我们还将在这些概念上介绍新的概念。

为了保证课程长度的可控性，主题可能会被分割到后续的几个课程当中。如果你觉得某个重要的概念在某一节中没有讲到，有可能会在下一节课中讲到。

# 语句

计算机程序是一连串的指令，告诉计算机该做什么。语句是一种是程序执行某些动作的指令类型(译注: 这里会想不通和汇编指令的区别，这个地方的指令可以理解为更高级别的汇编指令 -->> 一条语句会被实质翻译成多条汇编指令)。

语句是目前C++程序中最常见的指令类型。这是因为它们是C++语言中最小的独立单元。在这方面，它们的行为很像自然语言中的句子。当我们想向另外一个人传达一个想法的时候，我们通常用句子来写或者说话(而不是用随机的单词或者音节)。在C++中，当我们想让我们的程序做某事的时候，我们通常会写语句。

在C++中，大多数(但不是所有)语句都以分号结束。如果你看到一行分号结尾的语句，那很可能是一条语句。

在C++这样的高级语言中，一条语句可能会被编译成许多机器语言指令。

> ### 给高级读者
>
> 在C++中，有许多不同类型的语句:
>
> 1. 声明语句
> 2. 跳转语句
> 3. 表达式语句
> 4. 复合语句
> 5. 选择(条件)语句
> 6. 迭代(循环)语句
> 7. try代码块
>
> 当你看完这个系列教程，你就会明白这些都是什么了!

# 函数和main函数

在C++中，语句通常被分组为称为函数的单元。一个函数按顺序执行语句的集合。当你学习编写自己的程序时，你能够创建自己的函数，并以任何你喜欢的方式混合和匹配语句(我们将在未来的课程中暂时如何操作)。

### 规则

每个C++程序都必须有一个名为main的特殊函数(全部为小写字母)。当程序运行的时候，从main函数的第一条语句开始执行，然后依次进行。

当main函数内的最后一条语句被执行时，程序终止(尽管在某些情况下它们可能会提前终止)。

函数通常是为了完成特定的工作而编写的。比如，一个名为`max`的函数可能会包含计算两个数字中哪个更大的语句。一个名为`calculateGarde`的函数中可能会从一组测试分数中计算出一个学生的成绩。我们很快就会讨论更多关于函数的内容，因为它们是程序中最常用的组织工具。

> ### 作者笔记
>
> 当讨论函数的时候，在函数名称末尾加上括号是相当常见的速记方法。比如，如果你看到术语`main()`或者`doSomething()`，这就是名字为main和doSomething函数的速记。这将有助于将函数和其他类型(比如变量)区分开来，而不需要每次都写`函数`一词。

### Hello World解析

现在，你已经对什么是语句和函数有了简单的了解，让我们回到我们的`Hello World`程序，更深入地了解每一行的作用。

```c++
#include <iostream>

int main()
{
  std::cout << "Hello World!";
  return 0;
}
```

第一行是一种特殊类型的行，称之为预处理程序指令。这个预处理程序指令表明，我们希望使用iostream库的内容，它是C++标准库的一部分，允许我们从/向控制台读写文本。为了在第五行使用`std::cout`，我们需要这一行。排除这一行会导致第五行出现编译错误，因为编译器不知道`std::cout`是个啥。

第二行是空白行，被编译器忽略。这一行存在的目的只是为了让程序更易读(通过分离#include预处理指令和程序的后续部分)。

第三行告诉编译器，我们要写(定义)一个叫做main的函数。正如你在上面所学到的，每个C++程序都必须有一个main函数，否则会编译失败。

第四行和第七行告诉编译器哪些行是main函数的一部分。从第4行的大括号到第7行的大括号之间的所有内容都被认为是主函数的一部分。这就是所谓的函数主体。

第五行是main函数的第一条语句，也是我们运行程序时要执行的第一条语句。`std::cout(cout是 character out的缩写)`和<< 操作符允许我们将字母和数字发送到控制台进行输出。在本例中，我们要向它发送文本 Hello World！，它将被输出到控制台。这条语句创建了程序的可见输出。

第六行是一个返回语句。当一个可执行程序完成运行后，程序会向操作系统发送一个值，以表明它是否执行成功。这个特殊的返回语句向操作系统返回的值是0，意思是一切顺利!，这是程序中执行的最后一条语句。

我们写的所有程序都会遵循这个一般模版，或者它的一个变体。

> ### 作者笔记
>
> 如果上述解释的部分(或者全部)让人感到困惑，那也是意料之中的事情，这只是为了提供一个快速的概述，随后的课程将深入探讨上述所有主题，并提供大量附加示例和说明。

你可以自己编译并运行这个程序，你会看到它向控制台输出以下内容

```text
Hello World!
```

如果你在编译或者执行这个程序的时候遇到问题，请查看第0.8节

# 语法和语法错误

在英语中，句子是按照特定的语法规则来构造的，你可能在学校的英语课上学到了这些规则。比如，正常的句子都是使用句号结束。在一种语言中，支配句子如何构造的规则叫做语法。如果你忘记了添加句号，把两个句子连在一起，这就违反了英语的语法。

C++也有一套语法：关于你的程序必须如何构造才能被认为是有效的规则。当你编译你的程序的时候，编译器负责确保你的程序遵循C++语言的基本语法。如果你违反了某个规则，编译器会在你试图编译你的程序的时候抱怨，并向你抛出一个语法错误。

让我么看看如果我们省略Hello World程序第五行的分号，会发生什么，就像这样:

```c++
#include <iostream>

int main()
{
  std::cout << "Hello World!"
  return 0;
}
```

你可以自己编译一下这个语法错误的程序。

Visual Studio产生了以下错误(你的编译器可能会产生不同的错误信息)：

```text
c:\vcprojects\test1.cpp(6): error C2143: syntax error : missing ';' before 'return'
```

这是在告诉你，你在第六行有一个语法错误：编译器希望在返回语句前面有一个分号，但是它没有找到。虽然编译器会告诉你，当它遇到语法错误的时候，它正在编译哪一行代码，但是实际上遗漏的地方可能在前一行。在这种情况下，错误实际是在第五行末尾(编译器直到第六行才发现这个问题)

在编写程序的时候，语法错误是很常见的，幸运的是，它们通常很容易查找和修复，因为编译器通常会直接指向它们。只有在解决了所有语法错误之后，程序的编译才完成。

你可以尝试删除"Hello World"程序中的字符甚至整行，看看会产生什么样的错误。试着恢复第五行末尾的缺失的分号，然后删除第1、3或者4行，看看会发生什么。

# 测验时间

下面的测验是为了加强你对上述材料的理解

问题1:

什么是语句

语句是计算机程序中的指令，它告诉计算机执行一个动作

问题2:

什么是函数

函数是一个依次执行的语句集合

问题3:

所有的程序都必须有的函数名称是什么

main

问题4:

当程序运行时，从哪里开始

从main函数的第一条语句开始

问题5:

C++中的语句经常以什么结尾

分号

问题6:

什么是语法错误

语法错误是指你的程序违反C++语言的语法规则时，在编译过程中发生的编译器错误

问题7:

什么是C++标准库

库文件时一个预编译代码的集合，这些代码已经被打包，以方便在其他程序中重复使用。C++标准库是C++附带的一个库。它包含在程序中使用的附加功能。



