# 开发你的第一个程序

前面的课程已经介绍了大量的术语和概念，我们创建的每一个程序都会用到这些术语和概念。在这节课中，我们将逐步完成将这些知识整合到我们的第一个简单的程序中。

# 乘以2

首先，让我们创建一个程序，要求用户输入一个整数，等待用户输入一个整数，然后告诉他们这个数字的2倍是多少。程序应该产生以下输出(假设我输入的是4)。

```text
Enter an integer: 4
Double the number is: 8
```

我们如何解决这个问题? 分步解决

> ### 最佳实践
>
> 新手程序员经常试图一次性的写出整个程序，然后当它产生大量错误的时候就会不知所措。更好的策略是一次只写一块，确保它能正常编译，并测试它。然后，当你确定它能正常工作的时候，在继续写下一块。

我们将在这里利用这个策略。当我们进行每个步骤的时候，将每份代码手输（不要复制/粘贴）到你的编译器中，编译，然后运行它。

首先，创建一个新的控制台项目。

现在让我们从机械基本的脚手架开始。我们知道我们将需要一个`main()`函数（因为所有的C++程序必须都有一个）。所以如果你的IDE在你创建一个新的项目的时候没有创建一个空白的函数，那就创建一个:

```c++
int main()
{
  return 0;
}
```

我们知道我们需要将文本输出到文本控制台，并且从用户的键盘上获取文本，所以我们需要包含iostream来访问std::cout和std::cin。

```c++
#include <iostream>

int main()
{
  return 0;
}
```

现在让我们告诉用户，我们需要他们输入一个整数:

```c++
#include <iostream>

int main()
{
  std::cout << "Enter an integer:";
  return 0;
}
```

此时，你的程序应该产生这样的结果:

```text
Enter an integer: 
```

然后终止。

接下来，我们要获取用户输入。我们将使用`std::cin`和操作符`>>`来获取用户输入。但是我们还需要定义一个变量来存储这些输入，以便后面使用。

```c++
#include <iostream>

int main()
{
  std::cout << "Enter an integer:";
  
  int num{0};  // 定义一个int类型变量num;
  std::cin << num; // 从键盘获取用户输入
  
  return 0;
}
```

是时候编译我们的更改了.....然而.....

这是笔者在Visual Studio2017上得到的输出

```text
1>------ Build started: Project: Double, Configuration: Release Win32 ------
1>Double.cpp
1>c:\vcprojects\double\double.cpp(8): error C2678: binary '<<': no operator found which takes a left-hand operand of type 'std::istream' (or there is no acceptable conversion)
1>c:\vcprojects\double\double.cpp: note: could be 'built-in C++ operator<<(bool, int)'
1>c:\vcprojects\double\double.cpp: note: while trying to match the argument list '(std::istream, int)'
1>Done building project "Double.vcxproj" -- FAILED.
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========
```

我们遇到了一个编译错误！

首先，由于程序在我们更新之前是可以编译的，但是更新后无法编译了。所以错误一定是在我们刚刚添加的代码中(第七行和第八行)。这大大减少了查找错误需要查看代码的行数。第七行非常简单(只是一个变量定义)。因此错误不可能存在。所以第八行可能是罪魁祸首。

其次，这个错误消息不太容易阅读。但是，让我们挑选一些关键要素：编译器告诉我们它在第八行遇到错误，这意味错误实际可能在第八行，或者可能在前一行。这加强了我们之前的评估。接下来，编译器会告诉你，它找不到具有左操作数类型`std::istream`（也是std::cin的类型）的`<<`操作符。换句话说，操作符`<<`不知道该如何处理`std::cin`,所以错误一定是由于你使用了`std::cin`或者使用了操作符`<<`.

现在你发现错误了吗？如果你没有，请花一点时间看看你是否能找到它。

这是包含修正后的代码：

```c++
#include <iostream>

int main()
{
  std::cout << "Enter an integer: ";
  
  int num{0};
  std::cin << num;  // std::cin 使用操作符 >>，而不是操作符 << ！
  
  return 0;
}
```

现在编译程序，我们可以测试它。程序会等待你输入一个数字，所以我们输入4.输出应该是这样的.

```text
Enter an integer: 4
```

快好了！最后一步就是把数字翻倍。

一旦我们完成最后一步，我们的程序就会编译成功并且运行，产生需要的输出。

我们至少有三种方法可以解决这个问题。让我们从最坏到最好。

# 不好的解决方法

```c++
#include <iostream>

// 糟糕版
int main()
{
  std::cout << "Enter an integer: ";
  
  int num{0};
  std::cin >> num;
  num = num * 2;   // num乘以2，然后赋值给num
  std::cout << "Double that number is: " << num << '\n';
  return 0;
}
```

在这个解决方案中，我们使用一个表达式将num乘以2，然后将这个值赋值回给num。从这一点开始，num将包含我们翻倍的数字。

为什么这是一个糟糕的方案:

- 在赋值之前, num包含用户的输入。在赋值之后，它包含了一个不同的值，这让人困惑。
- 我们通过给输入变量赋值来覆盖用户的输入，所以如果我们想扩展我们的程序，在以后用这个输入值做其他的事情(比如将用户的值乘以3)，此时原始数据已经丢失了。

# 比较好的方案

```c++
#include <iostream>

int main()
{
  std::cout << "Enter an integer: ";
  int num{0};
  std::cin >> num;
  int doubuenum{num * 2};
  std::cout << "Double that number is: " << doublenum << '\n';
  return 0;
}
```

这个解决方案相当简单易懂，而且解决了最差解决方案中遇到的两个问题。

这里的主要缺点是，我们定义了一个新的变量(这增加了复杂性)来存储一个我们只用到一次的值。我们可以做的更好。

# 首选方案

```c++
#include <iostream>

int main()
{
  std::cout << "Enter an integer: ";
  int num{0};
  std::cin >> num;
  std::cout << "Double that number is: " << num * 2 << '\n';
  return 0;
}
```

这是几个解决方案中的首选。当执行`std::cout`的时候，表达式num*2被求值，num本身的值将不会被改变，如果我们愿意，可以在以后再次使用它。

这个版本是我们的参考方案

> ### 作者笔记
>
> 编程的第一个也是最主要的目标是让你的程序工作。一个不工作的程序无论写的多好都没有用。
>
> 不过，有句话我很喜欢，那就是: "你要写一次程序，才知道第一次应该怎么写。"，这说明最佳的解决方案往往不是显而易见的，我们第一次的解决方案往往都不尽如人意。
>
> 当我们专注于找出如何使我们的程序工作的时候，将大量时间投入到甚至不晓得最后是不是会被删除的代码是没有多大意义的，所以我们走捷径。我们会跳过错误处理和注释。我们在解决方案中穿插调试代码，以帮助我们诊断和查找错误。我们一边学一边做 -- 我们认为可能行得通的事情最终可能行不通，我们不得不回头尝试另外一种方法。
>
> 最终的结果是，我们最初的解决方案往往是结构不完整、不健壮(错误处理)，不可读，不简洁的。所以，一旦你的程序正常工作，你的工作其实并没有完成(除非这个程序是一次性的)。下一步是清理你的代码，这涉及到一些事情，比如：删除(或着注释掉)临时/调试代码，增加注释，处理错误情况，格式化你的代码，并确保遵循最佳实践。即使如此，你的程序可能也不是那么简单 -- 也许有多余的逻辑可以合并，或者多条语句可以合并，或者有不需要的变量，或者有千千万万的其他小事可以简化。新手程序员往往把注意力放在优化性能上面，而他们其实更应该优化的是代码的可维护性。
>
> 在这些教程中介绍的解决方案，很少有第一次出来就很棒的。相反，它们是不断完善的结果，直到找不到其他改进的地方。而在很多情况下，读者还能找到其他很多改进建议！
>
> 说这么多其实是想说：如果/当你的解决方案没有从你的大脑中直接出来完美优化的时候，不要沮丧，这很正常。编程中的完美是一个迭代的过程(需要反复执行的过程)。

> ### 作者笔记
>
> 这里有一点：你可能会想，“C++有这么多规则和概念，我怎么能记住这些东西呢？”
>
> 简短的回答是： 你不需要知道，使用你知道的那一部分，剩下的那部分需要的时候再去查找(WTF!!!!).........
>
> 当你第一次阅读本网站的时候，不要把精力放在记忆具体内容上，而需要尽可能的理解。然后，当你在编写你的程序的时候，你可以回到这里进行参考，重新了解如何做到这一点。

# 测验

### 问题1

修改最佳解决方案，让它输出如下内容(假设输入是4)

```text
Enter an integer: 4
Double 4 is: 8
Triple 4 is: 12
```

```c++
#include <iostream>

int main() {
    std::cout << "Enter an integer: ";
  
    int num{0};
    std::cin >> num;
  
    std::cout << "Double " << num << "is: " << num * 2 << '\n';
    std::cout << "Triple " << num << "is: " << num * 3 << '\n';
  
    return 0;
}
```

